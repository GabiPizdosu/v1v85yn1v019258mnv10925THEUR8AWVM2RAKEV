local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local roadColor = Color3.new(0, 0, 0) -- Replace with the color of your road
local speed = 50

-- Function to check if the road is in front of the car
local function isRoadInFront(car)
    if not car then
        return false
    end

    local primaryPart = car:FindFirstChild("PrimaryPart")
    if not primaryPart then
        return false
    end

    local rayStart = primaryPart.Position
    local rayDirection = primaryPart.CFrame.LookVector
    local raycastResult = workspace:Raycast(rayStart, rayDirection, {car})

    return raycastResult and raycastResult.Instance.BrickColor == BrickColor.new(roadColor)
end

-- Function to drive the car based on keyboard input
local function driveCar()
    local userInputService = game:GetService("UserInputService")

    userInputService.InputBegan:Connect(function(input)
        local car = character:FindFirstChildWhichIsA("Model") -- Adjust based on your car's class

        if not car then
            print("Car not found")
            return
        end

        if input.KeyCode == Enum.KeyCode.W then
            if isRoadInFront(car) then
                car:SetPrimaryPartCFrame(car:GetPrimaryPartCFrame() * CFrame.new(0, 0, -speed))
                print("Moving forward")
            else
                print("Road not detected. Adjusting direction.")
            end
        elseif input.KeyCode == Enum.KeyCode.S then
            car:SetPrimaryPartCFrame(car:GetPrimaryPartCFrame() * CFrame.new(0, 0, speed))
            print("Moving backward")
        elseif input.KeyCode == Enum.KeyCode.A then
            car:SetPrimaryPartCFrame(car:GetPrimaryPartCFrame() * CFrame.Angles(0, -math.rad(5), 0))
            print("Turning left")
        elseif input.KeyCode == Enum.KeyCode.D then
            car:SetPrimaryPartCFrame(car:GetPrimaryPartCFrame() * CFrame.Angles(0, math.rad(5), 0))
            print("Turning right")
        end
    end)
end

-- Start driving the car
driveCar()
