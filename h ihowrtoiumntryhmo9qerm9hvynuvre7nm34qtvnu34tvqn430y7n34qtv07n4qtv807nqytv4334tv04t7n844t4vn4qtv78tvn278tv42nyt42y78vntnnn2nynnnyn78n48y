local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local roadColor = Color3.new(0, 0, 0) -- Replace with the color of your road
local speed = 50

-- Function to check if the road is in front of the car
local function isRoadInFront()
    local car = character:FindFirstChildWhichIsA("Model") -- Adjust based on your car's class
    if not car then
        return false
    end

    local primaryPart = car:FindFirstChild("PrimaryPart")
    if not primaryPart then
        return false
    end

    local rayStart = primaryPart.Position
    local rayDirection = primaryPart.CFrame.LookVector
    local raycastResult = workspace:Raycast(rayStart, rayDirection, {car})

    if raycastResult and raycastResult.Instance.BrickColor == BrickColor.new(roadColor) then
        return true
    else
        return false
    end
end

-- Function to drive the car based on keyboard input
local function driveCar()
    local userInputService = game:GetService("UserInputService")

    userInputService.InputBegan:Connect(function(input)
        local car = character:FindFirstChildWhichIsA("Model") -- Adjust based on your car's class
        if not car then
            return
        end

        local primaryPart = car:FindFirstChild("PrimaryPart")
        if not primaryPart then
            return
        end

        if input.KeyCode == Enum.KeyCode.W then
            if isRoadInFront() then
                primaryPart.CFrame = primaryPart.CFrame * CFrame.new(0, 0, -speed)
            else
                -- Optionally, add logic to adjust direction or take alternative action when road is not detected
                print("Road not detected. Adjusting direction.")
            end
        elseif input.KeyCode == Enum.KeyCode.S then
            primaryPart.CFrame = primaryPart.CFrame * CFrame.new(0, 0, speed)
        elseif input.KeyCode == Enum.KeyCode.A then
            primaryPart.CFrame = primaryPart.CFrame * CFrame.Angles(0, -math.rad(5), 0)
        elseif input.KeyCode == Enum.KeyCode.D then
            primaryPart.CFrame = primaryPart.CFrame * CFrame.Angles(0, math.rad(5), 0)
        end
    end)
end

-- Start driving the car
driveCar()
